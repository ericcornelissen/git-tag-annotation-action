#!/bin/sh
. "$(dirname "$0")/common.sh"

# Pre
if [ ! "$(IS_MERGING)" ]; then
  git stash push --include-untracked --quiet
fi

# Checks
if command -v actionlint > /dev/null; then
  make lint-ci
fi
if command -v docker > /dev/null; then
  make lint-docker
fi
if command -v shellcheck > /dev/null; then
  make lint-sh
fi
if command -v gitleaks > /dev/null; then
  gitleaks protect
fi

# Post
if [ "$(DID_STASH)" ]; then
  git stash pop --quiet
fi
